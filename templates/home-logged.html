{% extends "includes/wrapper.html" %}
{% load staticoptimizer %}

{% block css %}
	{% css "css/src/home-logged.css" %}
{% endblock %}

{% block js %}
	{% js "js/src/ui/home-logged.js" %}
{% endblock %}

{% block mainclass %}can-edit{% endblock %}

{% block content %}
	<div id="cover-photo"></div>
	<div id="page-header" class="clearfix">
		<div id="profile-photo" class="fl"></div>
		<h1 class="fl editable" data-field="user.first_name">
			{{ user.get_full_name }}
		</h1>
	</div>
	
	
	<div class="manager-pannel">
		{% if not user.get_profile.musical_styles.all.count and not user.get_profile.equipament_types.all.count %}
		
		<h3>Fale mais sobre você:</h3>
		<p>Quanto mais informações você preencher, mais chances você tem de achar sua banda:</p>
		
		<section id="styles">
			Estilos que você gosta:
			<form action="/musico/atualizar/musical_styles" method="post" class="ajax inline-form">
				{% for style in musical_styles %}
					<label>
						<input type="checkbox" value="{{ style.id }}" name="musical_styles" /> {{ style.name }}
					</label>
				{% endfor %}
			</form>
		</section>
		
		<section id="instruments">
			Instrumentos que você toca:
			<form action="/musico/atualizar/type_instruments_play" method="post" class="ajax inline-form">
				{% for instrument in equipament_types %}
					<label>
						<input type="checkbox" value="{{ instrument.id }}" name="type_instruments_play" /> {{ instrument.name }}
					</label>
				{% endfor %}
			</form>
		</section>
		
		<section id="address" class="clearfix">
			Sua localidade:
			<form action="/musico/atualizar/address" method="post" class="ajax inline-form">
				<div class="fl">
					<label>Cep:</label>
					<input type="text" name="cep" id="cep" />
				</div>
				<div class="fl">
					<label>Rua:</label>
					<input type="text" name="street" id="street" />
					
					<label>Cidade:</label>
					<input type="text" name="street" id="street" />
					
					<label>Estado:</label>
					<input type="text" name="street" id="street" />
				</div>
			</form>
		</section>
		{% endif %}
		<div class="hide-parent" data-effect="slideUp">fechar</div>
	</div>
	
	<div class="message">
		{% for solicitation in band_solicitations %}
			<div class="box solicitation">
				<p>
				<strong>{{ solicitation.from_musician.user.get_full_name }}</strong> 
				disse que você toca
				{%for instrument in solicitation.instruments.all %}
					{{ instrument.name }}{% if not forloop.last %}, {%endif%}
				{% endfor %}
				na banda <strong>{{ solicitation.band.name }}</strong>
				</p>
				<a href="#accept" class="accept-solicitation" data-id="{{ solicitation.pk }}">Está certo</a>
				<a href="#decline" class="decline-solicitation" data-id="{{ solicitation.pk }}">Ele viajou</a>
			</div>
		{% endfor %}
	
		{% if user.get_profile.bands.count = 0 %}
			<div class="box without-bands">
				Você ainda não está em nenhuma banda cadastrada no Lasbandas.<br />
				<a href="/banda/cadastrar">Crie uma banda</a> ou <a href="#">Encontre uma banda que precisa de você</a>.
			</div>
		{% else %}
			<div class="box with-bands">
				Suas bandas:
				<ul>
					{% for music_band in user.get_profile.bands %}
						<li> 
							<a href="{{ music_band.band.encode_page }}" target="_blank">
							{{ music_band.band.name }} (
								{%for instrument in music_band.instruments.all %}
									{{instrument.name}}
									{% if not forloop.last %}, {%endif%}
								{% endfor %}
							)
							</a>
						</li>
					{% endfor %}
				</ul>
				
				<a href="/banda/cadastrar">[+] Cadastrar nova banda</a>
			</div>
		{% endif %}
	</div>
{% endblock %}

